import os

def options(opt):
	pass

def setup(conf):
	if 'darwin' in conf.env.PLATFORM:
		conf.check_framework('OpenCL', var='CLFramework')
		conf.find_program('openclc', mandatory=False)
	else:
		conf.check_lib('OpenCL', libpath=[os.path.join(conf.path.abspath(), 'lib.%s.%s'%(conf.env.VALID_PLATFORMS[0], a)) for a in conf.env.VALID_ARCHITECTURES])

def build(bld):
	if bld.env.CLFramework or bld.env.OpenCL or bld.env.PROJECTS:
		bld.thirdparty('3rdparty.OpenCL', libs=bld.env.OpenCL, frameworks=bld.env.CLFramework)
		bld.features.append('OpenCL')

